<html>
    <style>
        .box {
            width: 760px; height: fit-content; margin: 100px auto; padding: 20px; border: 1px solid black; border-radius: 4px
        }
        .txt {
            font-size: 22px;
        }
        .inputbox {
            font-size: 22px; position: relative; width: 400px; height: 40px; border: 1px solid black; border-radius: 4px
        }
        .littleinputbox {
            font-size: 22px; position: relative; width: 170px; height: 40px; border: 1px solid black; border-radius: 4px;
        }
        .littleselectbox {
            font-size: 20px; position: relative; width: 170px; height: 40px; border: 1px solid black; border-radius: 4px; background-color: #eee;
        }
        .innerbox {
            padding: 10px;
            text-align: right;
            margin-right: 100px;
        }
        .dorainnerbox {
            padding: 10px;
            text-align: right;
            margin-right: 10px;      
        }
        .dora {
            margin-left: 110px;
            display: flex;
        }
        .cb {
            width: 20px;
            height: 20px;
        }
        .innerbox2 {
            padding: 0 20px;
        }
        .col1 {
            text-align: left;
            font-size: 20px;
            width: 200px;
        }
        .col2 {
            text-align: right;
            font-size: 20px;
            width: 200px;
        }
    </style>
    <header>
        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    </header>
    <body>
        <div id="main">
            <div class="box">
                <h1 style="text-align: center">立直麻雀点数在线计算</h1>
                <div class="innerbox">
                    <a class="txt">手牌：</a>
                    <input class="inputbox" placeholder="23405m46p5p" v-model="inner">
                </div>
                <div class="innerbox">
                    <a class="txt">副露（空格分隔）：</a>
                    <input class="inputbox" placeholder="444s 567s" v-model="outer">
                </div>
                <div class="dora">
                    <div class="dorainnerbox">
                        <a class="txt">宝牌：</a>
                        <input class="littleinputbox" placeholder="4m" v-model="dora">
                    </div>
                    <div class="dorainnerbox">
                        <a class="txt">里宝牌：</a>
                        <input class="littleinputbox" placeholder="4z" v-model="innerdora">
                    </div>
                </div>
                <div class="dora">
                    <div class="dorainnerbox">
                        <a class="txt">场风：</a>
                        <select v-model="placewind" class="littleselectbox">
                            <option v-for="c in windList" :value="c.value" :key="c.value">{{ c.name }}</option>
                        </select>
                    </div>
                    <div class="dorainnerbox">
                        <a class="txt">自风：</a>
                        <select v-model="selfwind" class="littleselectbox">
                            <option v-for="c in windList" :value="c.value" :key="c.value">{{ c.name }}</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; width: fit-content; margin: 20px auto;">
                    <div class="innerbox2">
                        <a class="txt">立直</a>
                        <input class="cb" type="checkbox" v-model="reach">
                    </div>
                    <div class="innerbox2">
                        <a class="txt">自摸</a>
                        <input class="cb" type="checkbox" v-model="tsumo">
                    </div>
                </div>

                <div style="display: flex; width: fit-content; margin: 20px auto;">
                    <div class="innerbox2">
                        <a class="txt">海底</a>
                        <input class="cb" type="checkbox" v-model="haidi">
                    </div>
                    <div class="innerbox2">
                        <a class="txt">河底</a>
                        <input class="cb" type="checkbox" v-model="hedi">
                    </div>
                    <div class="innerbox2">
                        <a class="txt">岭上</a>
                        <input class="cb" type="checkbox" v-model="lingshang">
                    </div>
                    <div class="innerbox2">
                        <a class="txt">枪杠</a>
                        <input class="cb" type="checkbox" v-model="qianggang">
                    </div>
                </div>

                <div style="display: flex; width: fit-content; margin: 20px auto;">
                    <div class="innerbox2">
                        <a class="txt">双立直</a>
                        <input class="cb" type="checkbox" v-model="wreach">
                    </div>
                    <div class="innerbox2">
                        <a class="txt">一发</a>
                        <input class="cb" type="checkbox" v-model="yifa">
                    </div>
                    <div class="innerbox2">
                        <a class="txt">天和</a>
                        <input class="cb" type="checkbox" v-model="tianhe">
                    </div>
                    <div class="innerbox2">
                        <a class="txt">地和</a>
                        <input class="cb" type="checkbox" v-model="dihe">
                    </div>
                </div>
                <div style="display: flex; width: fit-content; margin: 20px auto;">
                    <button @click="send" style="width: 200px; height: 40px; border-radius: 4px; font-size: 20px">计算</button>
                </div>
                <div v-for="yaku in result.data.yakus" style="display: flex; width: fit-content; margin: 10px auto;">
                    <div class="col1">{{ getYakuInfo(yaku, result.data.inner)[0] }}</div>
                    <div class="col2">{{ getYakuInfo(yaku, result.data.inner)[1] }}番</div>
                </div>
                <div style="display: flex; width: fit-content; margin: 10px auto; border-top: 2px solid black">
                    <div class="col1">合计</div>
                    <div class="col2">{{ result.data.fu }}符{{result.data.fan}}番</div>
                </div>
                <div style="display: flex; width: fit-content; margin: 10px auto;">
                    <div class="col1">得点</div>
                    <div class="col2">{{ (result.data.isQin) ? ((result.data.tsumo) ? up(result.data.perPoint * 2) + "All" : up(result.data.perPoint * 6)) : ((result.data.tsumo) ? up(result.data.perPoint) + "-" + up(result.data.perPoint * 2): up(result.data.perPoint * 4))  }} </div>
                </div>
            </div>
        </div>
        <script>
            var a = new Vue({
                el: "#main",
                data: {
                    inner: "",
                    outer: "",
                    dora: "",
                    innerdora: "",
                    reach: false,
                    tsumo: false,
                    
                    selfwind: 0,
                    placewind: 0,
                    
                    yifa: false,
                    haidi: false,
                    hedi: false,
                    lingshang: false,
                    qianggang: false,
                    wreach: false,
                    tianhe: false,
                    dihe: false,

                    windList: [
                        {name: "东", value: 0},
                        {name: "南", value: 1},
                        {name: "西", value: 2},
                        {name: "北", value: 3},
                    ],

                    result: {
                        "status": 200,
                        "data": {
                            "yakus": [
                                5,
                                101,
                                201
                            ],
                            "fan": 3,
                            "fu": 30,
                            "perPoint": 960,
                            "inner": false,
                            "tsumo": false,
                            "isQin": true,
                            "yakuman": false
                        }
                    }
                },
                methods: {
                    send() {
                        console.log
                        let that = this;
                        axios({
                            method: "get",
                            url: "http://47.100.50.175:8080/cal",
                            data: {
                                inner: that.inner,
                                outer: that.outer,
                                dora: that.dora,
                                innerdora: that.innerdora,
                                reach: that.reach,
                                tsumo: that.tsumo,
                                selfwind: that.selfwind,
                                placewind: that.placewind,
                                yifa: that.yifa,
                                haidi: that.haidi,
                                hedi: that.hedi,
                                lingshang: that.lingshang,
                                qianggang: that.qianggang,
                                wreach: that.wreach,
                                tianhe: that.tainhe,
                                dihe: that.dihe
                            }
                        }).then(response => that.result = response.data);
                    },
                    up(num) {
                        return Math.ceil(num / 100) * 100;
                    },
                    getYakuInfo(yaku_id, inner) {
                        if (Math.floor(yaku_id / 100) == 1) return ["宝牌", yaku_id % 100];
                        if (Math.floor(yaku_id / 100) == 2) return ["赤宝牌", yaku_id % 100];
                        if (Math.floor(yaku_id / 100) == 3) return ["里宝牌", yaku_id % 100];
                        ids = [1, 2, 3, 4, 5, 6, 71, 72, 73, 74, 75, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41];
                        names = ["立直", "一发", "门前清自摸和", "平和", "断幺九", "一杯口", "役牌：场风牌", "役牌：自风牌", "役牌：白", "役牌：发", "役牌：中", "海底捞月", "河底捞鱼", "枪杠", "岭上开花", "两立直", "七对子", "一气通贯", "三色同顺", "混全带幺九", "三色同刻", "三暗刻", "对对和", "小三元", "混老头", "三杠子", "混一色", "纯全带幺九", "二杯口", "清一色", "国士无双", "四暗刻", "小四喜", "字一色", "绿一色", "清老头", "九莲宝灯", "四杠子", "天和", "地和", "国士无双十三面", "大四喜", "四暗刻单骑", "纯正九莲宝灯"];
                        fan_mq = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 26, 26, 26, 26];
                        fan_fl = [0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 0, 5, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 26, 26, 26, 26];
                        return [names[ids.indexOf(yaku_id)], (inner) ? fan_mq[ids.indexOf(yaku_id)] : fan_fl[ids.indexOf(yaku_id)]];
                    }
                }
            })
        </script>
    </body>
</html>